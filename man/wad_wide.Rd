% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wad_wide.R
\name{wad_wide}
\alias{wad_wide}
\title{Wide-format for WAD values}
\usage{
wad_wide(
  data,
  tax_id = c(),
  sample_id = c(),
  wads = "wad",
  iso_trt = c(),
  isotope = c(),
  average_light = TRUE
)
}
\arguments{
\item{data}{Data as a long-format data.table where each row represents a taxonomic feature within a single fraction.
Typically, this is the output from the \code{calc_wad} function.}

\item{tax_id}{Column name specifying unique identifier for each taxonomic feature.}

\item{sample_id}{Column name specifying unique identifier for each replicate.}

\item{wads}{Column name specifying weighted average density values.}

\item{iso_trt}{Column name specifying a two-level categorical column indicating whether a sample has been amended with a stable isotope (i.e., is "heavy") or if
isotopic composition is at natural abundance (i.e., "light").
Any terms may be applied but care should be taken for these values.
If supplied as a factor, \code{calc_excess} will take the lowest level as the "light" treatment and the higher
level as the "heavy" treatment.
Alternatively, if supplied as a character, \code{calc_excess} will coerce the column to a factor and with the default behavior wherein the
first value in alphabetical order will be assumed to be the lowest factor level (i.e. the "light" treatment).}

\item{average_light}{Whether to average the "light" WAD values.}
}
\value{
\code{wad_wide} returns a wide-transformed data.table where each row represents a taxonomic feature within a single replicate.
 If averaging unamended ("light") values is not performed, each taxon will have one numeric value and one \code{NA}
 value based on whether it was present in an unamended "light" sample or an amended "heavy" sample.

 If \code{iso_trt} is not a factor, then it will be coerced to one and it will
 return a message telling the user which value was assigned to which isotope labeling level.
 Most users adopt a scheme of using the terms "light" and "label" to define their
 treatments but please note that the word "label" comes first in the alphabet and
 will be assigned by the function to be the unlabeled or light treatment.
 If you wish to avoid this (you almost certainly do), you must specify your factor levels beforehand.
}
\description{
Transforms weighted average density values into wide-format
}
\examples{
 # Load in example data
 data(example_qsip)

 # relativize sequence abundances (should be done after taxonomic filtering)
 example_qsip[, rel_abund := seq_abund / sum(seq_abund), by = sampleID]

 # ensure that the "light" treatment is the first factor level in the isotope treatment column
 levels(example_qsip$iso_trt)

 # calculate weighted average densities
 wads <- calc_wad(example_qsip,
                  tax_id = 'asv_id', sample_id = 'sampleID', frac_id = 'fraction',
                  frac_dens = 'Density.g.ml', frac_abund = 'avg_16S_g_soil',
                  rel_abund = 'rel_abund',
                  grouping_cols = c('treatment', 'isotope', 'iso_trt', 'Phylum'))

 # transform to wide format
 ww <- wad_wide(wads, tax_id = 'asv_id', sample_id = 'sampleID',
                iso_trt = 'iso_trt', isotope = 'isotope')

}
\seealso{
\code{\link{calc_wad}}, \code{\link{calc_excess}}
}
